var ifTree=function(){var t=function(t,e){if(this.elem=document.getElementById(t),this.options=e||{},!this.elem)throw"Element #{{0}} not found.".replace("{{0}}",t);this.init()};return t.prototype.init=function(){this.nodes=this.options.nodes||{},this.nodes.nowhere||(this.nodes.nowhere={text:"<p>You are not sure where you are.</p>"}),this.resetFlags(),this.elem.addEventListener("click",function(t){"BUTTON"===t.target.tagName&&this.selectOption(this.currentNode,t.target.value)}.bind(this)),this.currentNode=this.nodes[this.options.start||"start"],this.showNode(this.currentNode)},t.prototype.showNode=function(t){if(t&&t.text||(console.log("No node, defaulting to nowhere"),t=this.nodes.nowhere),t.onShow&&"function"==typeof t.onShow){var e=t.onShow.call(this);if("string"==typeof e)return void this.goTo(e)}var s=t.text,o=[];if(t.messages)for(var i=0;i<t.messages.length;i++){var n=t.messages[i];(!n.showIf&&!n.showIfNot||n.showIf&&this.flags[n.showIf]||n.showIfNot&&!this.flags[n.showIfNot])&&o.push(n.text)}var r=[];if(t.options&&t.options.length>0)for(var h=0;h<t.options.length;h++){var a=t.options[h];(!a.showIf&&!a.showIfNot||a.showIf&&this.flags[a.showIf]||a.showIfNot&&!this.flags[a.showIfNot])&&r.push("<li><button value='{{0}}'>{{1}}</li>".replace("{{0}}",h).replace("{{1}}",a.label))}t.resetFlags&&this.resetFlags(),t.setFalse&&(this.flags[t.setFalse]=!1),t.setTrue&&(this.flags[t.setTrue]=!0),this.elem.innerHTML="{{0}}{{1}}<ul>{{2}}</ul>".replace("{{0}}",s).replace("{{1}}",o.join("")).replace("{{2}}",r.join(""))},t.prototype.selectOption=function(t,e){var s=t.options[e],o=s.target;if(s.onSelect&&"function"==typeof s.onSelect){var i=s.onSelect.call(this);"string"==typeof i&&(o=i)}s.resetFlags&&this.resetFlags(),s.setFalse&&(this.flags[s.setFalse]=!1),s.setTrue&&(this.flags[s.setTrue]=!0),this.goTo(s.target.constructor==Array?s.target[Math.floor(Math.random()*s.target.length)]:s.target)},t.prototype.goTo=function(t){this.currentNode=this.nodes[t],this.showNode(this.currentNode)},t.prototype.resetFlags=function(){if(this.flags={},this.options.flags){this.flags=JSON.parse(JSON.stringify(this.options.flags));for(var t in this.options.flags)this.options.flags.hasOwnProperty(t)&&(this.flags[t]=this.options.flags[t])}},{init:function(e,s){return new t(e,s)}}}();